<!DOCTYPE html>
<html>
  {{ partial "header" .}}
  <body>
    <div class="wrapper">
      <header class="main_header">
        <h1><a href="/">{{ .Site.Title }}</a></h1>
        {{ partial "main_menu" . }}
      </header>
      {{ block "main" . }}
        <!-- The part of the page that begins to differ between templates -->
      {{ end }}
    </div>
    <footer>
      © <a href="mailto:petites@vadrouilles.co">✉️ Vadrouilles.co</a> 2018 {{ partial "menu" . }}
    </footer>
    {{ template "_internal/google_analytics.html" . }}
    <script src="https://cdn.jsdelivr.net/npm/cash-dom@1.3.5/dist/cash.min.js"></script>
    <script src="https://unpkg.com/flickity@2/dist/flickity.pkgd.min.js"></script>
    <script src="/js/medium-zoom.min.js"></script>
    <script src='https://api.mapbox.com/mapbox-gl-js/v0.44.1/mapbox-gl.js'></script>
    <script>
      $(function(){
        mediumZoom(document.querySelectorAll('.wander img'))
        {{ if .Params.geojson }}
          var data = {{ .Params.geojson | readFile | safeJS }}
          mapboxgl.accessToken = '{{ .Site.Params.mapbox }}';
          var map = new mapboxgl.Map({
            container: 'map',
            interactive: false,
            zoom: {{ .Params.zoom | default 14 }},
            center: [data.features[0].properties.longitude, data.features[0].properties.latitude],
            style: 'mapbox://styles/yannick-io/cjfp8z2h53ry82so1w3bw2coh'
          });
          map.on('load', function () {
            map.addLayer({
              "id": "route",
              "type": "line",
              "paint": {
                  "line-color": "#D9541C",
                  "line-width": 1.5
              },
              "source": {
                "type": "geojson",
                "data": data
              }
            })

          });
        {{ end }}
        {{ block "js" . }}
        {{ end }}
      })
    </script>
    <script src="https://unpkg.com/flickity-bg-lazyload@1.0.0/bg-lazyload.js"></script>
  </body>
</html>
