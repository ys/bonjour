{{ define "main" }}
{{ partial "cover.html" . }}
<div class="home with-links font-body mb-10">
  {{ .Content }}
</div>
<hr/>
<h3 class="text-xl text-center font-semibold">{{ T "recent" }}</h3>
<div class="grid grid-rows-3 md:grid-rows-1 md:grid-cols-3 gap-8 md:-mx-32 p-4">

{{ range (first 3 (where .Site.RegularPages "Type" "posts")) }}
<div class="my-4">
  {{ $image := .Resources.GetMatch "cover" }}
  {{if $image }}
  {{ $web := $image.Fill "1200x800" }}
  {{ $mini := $image.Fill "60x40 Box" }}
  <div class="mb-2">
    <a href="{{ .RelPermalink }}" aria-label="{{ .Title }}">
      <picture class="block shadow-lg">
        <source class="lazyload" srcset="{{ $mini.RelPermalink }}" type="web/jpg" media="(min-width: 821px)"
          data-srcset="{{ $web.RelPermalink }}">
        <img alt="{{ .Title }} cover" src="{{ $mini.RelPermalink }}" data-src="{{ $web.RelPermalink }}"
          class="w-full lazyload">
      </picture>
    </a>
  </div>
  {{end}}
  <header class="text-center">
    <h2 class="text-lg font-semibold font-display text-darker dark:text-gray-100">
      <a href="{{ .RelPermalink }}">
        {{ .Title }}
      </a>
    </h2>
    <h3 class="mx-2 italic font-body text-sm text-gray-600 dark:text-gray-300">
      {{ with .Params.subtitle }}
      {{ . }}
      {{ end }}
    </h3>
  </header>
</div>
{{ end }}
</div>
<hr/>
<div class="pt-4 pb-8">
{{ range (first 5 (where .Site.RegularPages "Type" "journal")) }}
<div class="py-4">
  <div class="font-sans tracking-tight text-xs text-gray-700 dark:text-gray-300 uppercase">
    {{ .Params.emoji }}
    {{ .Date.Day }} {{ index .Site.Data.mois (printf "%d" .Date.Month) }} {{ .Date.Year }}
  </div>
  <header class="font-body">
    <h2 class="text-3xl text-darker dark:text-gray-100">
      <a href="{{ .RelPermalink }}">
        {{ .Summary | truncate 34 }}
      </a>
    </h2>
  </header>
  </div>

  {{ end }}
  </div>
{{ end }}
