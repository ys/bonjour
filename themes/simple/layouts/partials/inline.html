<article class="h-entry">
<header class="mb-6 relative ">
  <h2 class="text-xl hover:underline {{ with .Params.Color }}text-{{ . }}-600  {{ else }} text-accent-600{{ end }} transition ease-in-out duration-200">
    <a alt="section link" class="p-name u-url u-uuid" href="{{ .Parent.RelPermalink | default ("/" | relLangURL )}}">
    {{ .Title }}
    </a>
  </h2>
  <h3 class="text-gray-600 ">
    {{ with .Params.subtitle }}
    {{ . }}
    {{ end }}
  </h3>
</header>
<div data-pswp class="e-content mb-10 post content-{{ with .Params.color }}{{ . }}{{ else }}accent{{ end }}">
    {{ $allimages := slice }}
    {{ $journal := .Site.GetPage "/journal/images" }}
    {{ range .Params.images}}
      {{ $allimages = $allimages | append (dict "Image" ($journal.Resources.GetMatch .url)) }}
    {{ end }}
    {{ $rows := dict }}
    {{ $columns := dict }}
    {{ $rowid := 0 }}
    {{ $colid := 0 }}
    {{ $possibilities := slice 1 1  2 2 2 2 2 2 2 2 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 4 4 4 4 4 4 4 }}
    {{ $itemsonrow := index (shuffle $possibilities) 0 }}
    {{ range $index, $img := $allimages }}
      {{ $columns = merge $columns (dict (string (mod $index $itemsonrow)) (dict "Images" (slice $img)))}}
      {{ $colid = add $colid 1 }}
      {{ if eq $colid $itemsonrow }}
        {{ $rows = merge $rows (dict (string $rowid) $columns) }}
        {{ $itemsonrow = index (shuffle $possibilities) 0 }}
        {{ $columns = dict }}
        {{ $rowid = add $rowid 1 }}
        {{ $colid = 0 }}
      {{ end }}
    {{ end }}
    {{ $rows = merge $rows (dict (string $rowid) $columns) }}
    {{ partial "grid" $rows }}
  {{.Content}}
</div>
{{ partial "article_camera" . }}
<span class="text-xs mb-32  text-right font-sans  text-gray-700 capitalize block">
  {{ with .Params.emoji }}
    {{ . }}
  {{ else }}
    {{ partial "emoji" . }}
  {{ end }}
  {{ partial "category-link" . }}
  {{ .Site.Params.arrow }}
  <a href="{{ .RelPermalink }}">
    <time class="dt-published" datetime="{{ Date.Format "2006-01-02T15:04:05Z0700" }}">
      {{ .Date.Day }} {{ index .Site.Data.mois (printf "%d" .Date.Month) }} {{ .Date.Year }}
    </time>
  </a>
</span>
</article>
