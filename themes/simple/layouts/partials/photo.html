{{/* get file that matches the filename as specified as src="" in shortcode */}}
{{ $src := .Image }}

{{ if $src }}
  {{ $s := newScratch }}
  {{ partial "responsive-img-data" (dict "src" $src "scratch" $s) }}
   <div class="masonry-item relative group" >
     <picture class="{{ .ExtraClasses }} aspect-[{{.Image.Width}}/{{.Image.Height}}] relative box-border block ">
      {{- /* Generate better alt text: use description, then page title, then filename */ -}}
      {{- $altText := "" -}}
      {{- if .Description -}}
        {{ $altText = .Description }}
      {{- else if .Page -}}
        {{- $filename := $src.Name | path.Base | replaceRE "\\.[^.]+$" "" | humanize | title -}}
        {{ $altText = printf "%s - %s" .Page.Title $filename }}
      {{- else -}}
        {{ $altText = $src.Name | path.Base | replaceRE "\\.[^.]+$" "" | humanize | title }}
      {{- end -}}
      {{ if $s.Get "has_avif" }}
        <source type="image/avif" srcset="{{ $s.Get "srcset_avif" }}" sizes="(min-width: 48rem) 33vw, 100vw">
      {{ end }}
      <img
        loading="lazy"
        style="background: url(data:image/webp;base64,{{ ($s.Get "lqip").Content | base64Encode  }}); background-size: cover"
        alt="{{ $altText }}"
        class="{{if .Page }}group-hover:opacity-40 {{ end }} hover:shadow-{{ $.Scratch.Get "color" }}/20 shadow-md hover:shadow-xl   cursor-pointer object-cover lazy absolute top-0 left-0 w-full h-full"
        data-action="zoom"
        {{ if not ($s.Get "is_gif") }}
          srcset="{{ $s.Get "srcset_webp" }}"
          sizes="(min-width: 48rem) 33vw, 100vw"
        {{ end }}
        data-zoom-src="{{ ($s.Get "zoom").RelPermalink }}"
        src="{{ ($s.Get "default").RelPermalink }}"
        msrc="{{ ($s.Get "lqip").RelPermalink }}"
        data-src="{{ ($s.Get "default").RelPermalink }}"
        width="{{ ($s.Get "default").Width }}" height="{{ ($s.Get "default").Height }}"/>
    </picture>
    {{ with .Page }}
      <div class=" pl-4 pb-8 lg:pb-0 lg:absolute top-0 left-0 h-full w-full group-hover:backdrop-blur-sm group- group-hover:block  group-hover:flex flex-col mdenter justify-center  lace-items-center lg:hidden group-hover:block">
          <header class="">
            <span class="font-sans tracking-tight text-xs transition ease-in-out duration-200 ">
              {{ with .Params.pricetag }}
                {{ . | markdownify }}
              {{ else }}
                {{ .Date.Day }} {{ index .Site.Data.mois (printf "%d" .Date.Month) }} {{ .Date.Year }}
              {{ end }}
            </span>
            <h2 class="text-lg font-semibold {{ with .Params.Color }}text-{{ . }} {{ else }}text-accent{{ end }} transition ease-in-out duration-200">
                {{ .Title  |markdownify}}
            </h2>
            <h3 class="line-clamp-1 text-sm dark:text-gray-200 text-crust italic transition ease-in-out duration-400 ">
              {{ with .Params.subtitle }}
              {{ . }}
              {{ else }}
                {{ with .Params.description }}
                  {{ . | truncate 100 }}
                {{ else}}
                  {{ .Summary |markdownify | truncate 100 }}
                {{ end }}
              {{ end }}
            </h3>
            <h4 class="text-xs font-sans {{ with .Params.Color }}group-hover:text-{{ . }}-600 {{ else }}group-hover:text-accent-600{{ end }} transition ease-in-out duration-200">
            </h4>
          </header>
      </div>
    {{ end }}
   </div>
{{ end }}
