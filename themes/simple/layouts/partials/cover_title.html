  {{ $images := .Resources.ByType "image" }}
  {{ $src := $images.GetMatch "*cover*" }}
  {{ $src := $images.GetMatch "*feature*" }}
  {{ $src := cond (ne $src nil) $src ($images.GetMatch "{*cover*,*thumbnail*}") }}
  {{ $src := cond (ne $src nil) $src (index $images 0) }}

  {{/* set image sizes, these are hardcoded for now, x dictates that images are resized to this width */}}

  {{ $lqipw := default "30x20" }}
  {{ $smallw := default "300x200" }}
  {{ $largew := default "600x400" }}

  {{/* resize the src image to the given sizes */}}

  {{ $lqip := $src.Fill $lqipw }}
  {{ $small := $src.Fill $smallw }}
  {{ $large := $src.Fill $largew }}

  {{/* only use images smaller than or equal to the src (original) image size, as Hugo will upscale small images */}}
  {{/* set the sizes attribute to (min-width: 35em) 1200px, 100vw unless overridden in shortcode */}}
  <article class="flex flex-col text-center">
    <a href="{{ .RelPermalink }}">
      <picture
        class="block relative mt-2 aspect-w-3 aspect-h-2"
        style="background: url(data:image/jpeg;base64,{{ $lqip.Content | base64Encode  }}); background-size: cover">
        <img loading="lazy" class="m-0 h-auto w-full lazyload" alt="cover {{ .Title}}" data-action="zoom"
          data-zoom-src="{{ $large.RelPermalink}}" sizes="auto" srcset='
            {{ if ge $src.Width "400" }}
              {{ with $small.RelPermalink }}{{.}} 400w{{ end }}
            {{ end }}
            {{ if ge $src.Width "800" }}
              {{ with $large.RelPermalink }}, {{.}} 800w {{ end }}
            {{ end }}' src="{{ $large.RelPermalink }}" width="{{ $large.Width }}" height="{{ $large.Height }}">
      </picture>
      <h2 class="font-bold text-sm mt-2 text-gray-700 uppercase">{{.Title}}</h2>
      {{ with .Params.subtitle }}
      <h3 class="font-normal text-sm mt-2 text-gray-400">{{.}}</h3>
      {{end}}
    </a>
  </article>
