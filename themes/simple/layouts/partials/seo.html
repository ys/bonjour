{{ $title := printf "%d %s %d - %s" .Date.Day (index .Site.Data.mois (printf "%d" .Date.Month)) .Date.Year $.Site.Title }}
{{ $tags := slice }}
{{ if isset .Params "tags" }}
{{ if reflect.IsSlice .Params.tags }}
{{ $tags = delimit .Params.tags ", " }}
{{ else }}
{{ $tags = .Params.tags }}
{{ end }}
{{ end }}
{{ if .Params.seotitle }}
  {{ $title = .Params.seotitle }}
{{ else if .Title }}
  {{ $title = printf "%s - %s" .Title $.Site.Title }}
{{ end }}
{{ $colorHex := index  .Site.Data.palette (.Site.Params.themePalette) ($.Scratch.Get "color") "hex"  }}
{{ $description := with .Description }}{{ . }}{{ else }}{{ with .Site.Params.description }}{{ . }}{{ end }}{{ end }}
{{ $description = $description | truncate 160 }}

<title>{{ $title }}</title>
<meta name="theme-color" media="(prefers-color-scheme: light)" content="{{$colorHex}}" />
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="#232634" />
{{ if in .Site.Params.doNotIndex .Type }}
    <meta name="robots" content="noindex, nofollow">
{{ else }}
    <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">
{{ end }}
<link rel="apple-touch-icon" sizes="180x180" href="/{{ $.Scratch.Get "color"}}/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/{{ $.Scratch.Get "color"}}/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/{{ $.Scratch.Get "color"}}/favicon-16x16.png">
<link rel="manifest" href="/{{ $.Scratch.Get "color"}}/site.webmanifest">
<link rel="mask-icon" href="/{{ $.Scratch.Get "color"}}/safari-pinned-tab.svg" color="{{ $colorHex}}">
<meta name="apple-mobile-web-app-title" content="Bonjour Yannick">
<meta name="application-name" content="Bonjour Yannick">
<meta name="msapplication-TileColor" content="{{$colorHex}}">
<meta name="description" content="{{ $description }}" />
{{ if $tags }}<meta name="keywords" content="{{ $tags }}">{{ end }}
<link rel="canonical" href="{{ .Permalink }}" />
<meta name="author" content="{{ .Site.Params.author.name | default "Yannick Schutz" }}" />
<meta name="p:domain_verify" content="{{ .Site.Params.pinterestVerify }}" />
{{ if .IsTranslated }}
  {{ range .Translations }}
    <link rel="alternate" hreflang="{{ .Language.LanguageCode }}" href="{{ .Permalink }}" />
  {{ end }}
  <link rel="alternate" hreflang="{{ .Language.LanguageCode }}" href="{{ .Permalink }}" />
{{ end }}
{{- $images := $.Resources.ByType "image" -}}
{{- $featured := $images.GetMatch "*feature*" -}}
{{- $featured := cond (ne $featured nil) $featured ($images.GetMatch "{*cover*,*thumbnail*}") -}}
{{- $card := $images.GetMatch "card*" -}}
{{- $ogImage := cond (ne $card nil) $card $featured -}}
{{- $ogImage = cond (ne $ogImage nil) $ogImage (index ($.Site.Params.images | default slice) 0) -}}

<script type="application/ld+json">
[
{{ if and (eq .Type "shop") .IsPage}}
{
"@context": "https://schema.org/",
"@type": "Product",
"name": {{ $title | jsonify }},
"headline": {{ $title | jsonify }},
"description": {{ with (.Description | default (replaceRE "\n" " " (.Summary | truncate 170))) }}{{ . | jsonify }}{{ else }}""{{ end }},
"inLanguage": "{{.Lang}}",
{{- with $featured -}}
"image": {
  "@type": "ImageObject",
  "url": {{ .Permalink | jsonify }},
  "width": {{ .Width | default 1200 }},
  "height": {{ .Height | default 630 }}
},
{{- else -}}
{{- with $ogImage -}}
"image": {{ if reflect.IsString . }}{{ . | absURL | jsonify }}{{ else }}{{ . | jsonify }}{{ end }},
{{- end -}}
{{- end -}}
"offers": {
  "@type": "Offer",
  "priceCurrency": {{ .Params.currency | default "EUR" | jsonify }},
  "price": "{{.Params.price }}",
  "priceValidUntil": "2029-11-05",
  "availability": "{{ if .Params.soldout }}http://schema.org/SoldOut{{ else }}http://schema.org/InStock{{ end }}",
  "url": {{ .Permalink | jsonify }},
  "seller": {
    "@type": "Person",
    "name": {{ $.Site.Params.author.name | default "Yannick Schutz" | jsonify }}
  }
},
"brand": {
  "@type": "Brand",
  "name": {{ $.Site.Title | jsonify }}
}
}
{{ else }}
{
"@context": "https://schema.org",
"@type": "BlogPosting",
"mainEntityOfPage": {
  "@type": "WebPage",
  "@id": {{ .Permalink | jsonify }}
},
"articleSection": {{ .Section | jsonify }},
"name": {{ $title | jsonify }},
"headline": {{ $title | jsonify }},
"description": {{ with (.Description | default (replaceRE "\n" " " (.Summary | truncate 170))) }}{{ . | jsonify }}{{ else }}""{{ end }},
"inLanguage": "{{.Lang}}",
{{- with $featured -}}
"image": {
  "@type": "ImageObject",
  "url": {{ .Permalink | jsonify }},
  "width": {{ .Width | default 1200 }},
  "height": {{ .Height | default 630 }}
},
{{- else -}}
{{- with $ogImage -}}
"image": {{ if reflect.IsString . }}{{ . | absURL | jsonify }}{{ else }}{{ . | jsonify }}{{ end }},
{{- end -}}
{{- end -}}
"author": {
  "@type": "Person",
  "name": {{ $.Site.Params.author.name | default "Yannick Schutz" | jsonify }},
  "url": {{ $.Site.BaseURL | jsonify }},
  {{- with $.Site.Params.social.email -}}
  "email": {{ . | jsonify }},
  {{- end -}}
  {{- with $.Site.Params.social.instagram -}}
  "sameAs": ["https://instagram.com/{{ . }}"]
  {{- end -}}
},
"publisher": {
  "@type": "Person",
  "name": {{ $.Site.Params.author.name | default "Yannick Schutz" | jsonify }},
  "url": {{ $.Site.BaseURL | jsonify }}
},
"copyrightHolder": {
  "@type": "Person",
  "name": {{ $.Site.Params.author.name | default "Yannick Schutz" | jsonify }}
},
"copyrightYear": "{{ .Date.Format "2006" }}",
"datePublished": {{ .Date.Format "2006-01-02T15:04:05Z07:00" | jsonify }},
"dateModified": {{ .Lastmod.Format "2006-01-02T15:04:05Z07:00" | jsonify }},
"url": {{ .Permalink | jsonify }},
"wordCount": {{ .WordCount }},
{{- if $tags -}}
"keywords": {{ if reflect.IsSlice .Params.tags }}{{ .Params.tags | jsonify }}{{ else }}{{ split $tags ", " | jsonify }}{{ end }},
{{- end -}}
"breadcrumb": {
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "name": "Home",
      "item": {{ $.Site.BaseURL | jsonify }}
    },
    {
      "@type": "ListItem",
      "position": 2,
      "name": {{ .Section | title | jsonify }},
      "item": {{ ($.Site.GetPage .Section).Permalink | jsonify }}
    },
    {
      "@type": "ListItem",
      "position": 3,
      "name": {{ .Title | jsonify }},
      "item": {{ .Permalink | jsonify }}
    }
  ]
}
}
{{ end }},
{
"@context": "https://schema.org",
"@type": "Person",
"name": {{ $.Site.Params.author.name | default "Yannick Schutz" | jsonify }},
"jobTitle": "Photographer",
"url": {{ $.Site.BaseURL | jsonify }},
{{- $sameAs := slice -}}
{{- with $.Site.Params.social.instagram -}}{{- $sameAs = $sameAs | append (printf "https://instagram.com/%s" .) -}}{{- end -}}
{{- with $.Site.Params.social.twitter -}}{{- $sameAs = $sameAs | append (printf "https://twitter.com/%s" .) -}}{{- end -}}
{{- with $.Site.Params.social.github -}}{{- $sameAs = $sameAs | append (printf "https://github.com/%s" .) -}}{{- end -}}
{{- with $.Site.Params.social.mastodon -}}{{- $sameAs = $sameAs | append (printf "https://%s/@%s" .domain .username) -}}{{- end -}}
{{- if gt (len $sameAs) 0 -}}
"sameAs": {{ $sameAs | jsonify }},
{{- end -}}
"address": {
  "@type": "PostalAddress",
  "addressRegion": "Finist√®re",
  "addressCountry": "FR"
},
{{- with $.Site.Params.social.email -}}
"email": {{ . | jsonify }},
{{- end -}}
"description": {{ $.Site.Params.description | jsonify }}
}
{{- if .IsHome -}}
,
{
"@context": "https://schema.org",
"@type": "WebSite",
"name": {{ $.Site.Title | jsonify }},
"url": {{ $.Site.BaseURL | jsonify }},
"description": {{ $.Site.Params.description | jsonify }},
"author": {
  "@type": "Person",
  "name": {{ $.Site.Params.author.name | default "Yannick Schutz" | jsonify }}
},
"publisher": {
  "@type": "Person",
  "name": {{ $.Site.Params.author.name | default "Yannick Schutz" | jsonify }}
},
{{- with $.Site.Params.social.email -}}
"contactPoint": {
  "@type": "ContactPoint",
  "email": {{ . | jsonify }},
  "contactType": "customer service"
},
{{- end -}}
"potentialAction": {
  "@type": "SearchAction",
  "target": {
    "@type": "EntryPoint",
    "urlTemplate": {{ (printf "%s/search?q={search_term_string}" $.Site.BaseURL) | jsonify }}
  },
  "query-input": "required name=search_term_string"
}
}
{{- end -}}
]
</script>
